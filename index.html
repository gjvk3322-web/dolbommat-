<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RE:BOOT PRO v7.0 | AI ì»¨ì„¤íŒ… ì—°ë™ ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;600;700;800&display=swap');
        body { font-family: 'Pretendard', sans-serif; background-color: #f1f5f9; color: #1e293b; }
        
        .dashboard-container { max-width: 1400px; margin: 0 auto; background: #ffffff; padding: 30px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); }
        .section-title { font-size: 1.1rem; font-weight: 800; color: #1e293b; margin-bottom: 12px; display: flex; align-items: center; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px; }
        .section-title i { color: #3b82f6; margin-right: 8px; }

        .step-col { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 16px; display: flex; flex-direction: column; }
        .step-header { font-size: 1rem; font-weight: 800; text-align: center; padding: 10px; border-radius: 8px; margin-bottom: 16px; color: white; }
        
        .box-wrapper { background: #ffffff; border: 1px solid #cbd5e1; border-radius: 8px; overflow: hidden; margin-bottom: 12px; }
        .box-title { background-color: #f1f5f9; color: #334155; padding: 8px 12px; font-size: 0.85rem; font-weight: 700; border-bottom: 1px solid #e2e8f0; }
        
        textarea { width: 100%; border: none; padding: 12px; font-size: 0.85rem; line-height: 1.5; outline: none; resize: none; background: transparent; }
        textarea::placeholder { color: #94a3b8; font-style: normal; }
        
        /* ğŸŒŸ ì¸ì‡„(PDF) ì‹œ textareaë¥¼ ì¼ë°˜ í…ìŠ¤íŠ¸ ë°•ìŠ¤ë¡œ ë³´ì´ê²Œ ì²˜ë¦¬ */
        @media print {
            textarea { display: block; height: auto !important; overflow: visible; white-space: pre-wrap; word-wrap: break-word; background: white; border: none; }
            .box-wrapper { page-break-inside: avoid; margin-bottom: 10px; border: 1px solid #cbd5e1; }
            .no-print { display: none !important; }
            .dashboard-container { box-shadow: none; border: none; padding: 0; }
            body { background-color: white; }
        }

        .memo-pad { background-color: #fef9c3; border: 1px solid #fde047; box-shadow: inset 0 0 10px rgba(250, 204, 21, 0.2); }
        .memo-pad textarea { height: 100px; background: repeating-linear-gradient(transparent, transparent 27px, #fef08a 28px); line-height: 28px; padding-top: 4px; color: #854d0e; font-weight: 600; }
        
        .history-card { border-left: 5px solid #3b82f6; page-break-inside: avoid; }
        
        .auto-summary-list { height: 230px; overflow-y: auto; background: #f8fafc; padding: 12px; border-radius: 8px; border: 1px solid #cbd5e1; }
        .auto-summary-item { font-size: 0.85rem; padding: 8px; background: white; border: 1px solid #e2e8f0; border-radius: 6px; margin-bottom: 8px; box-shadow: 0 1px 2px rgba(0,0,0,0.02); }
        
        .gantt-grid { display: grid; grid-template-columns: 200px 1fr; gap: 10px; align-items: center; margin-bottom: 6px; page-break-inside: avoid; }
        .gantt-track { display: grid; grid-template-columns: repeat(8, 1fr); gap: 2px; background: #f1f5f9; border-radius: 6px; height: 32px; position: relative; border: 1px solid #e2e8f0; }
        .gantt-bar { border-radius: 4px; display: flex; align-items: center; padding: 0 10px; color: white; font-weight: 800; font-size: 0.75rem; white-space: nowrap; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .gantt-input { border: 1px solid #cbd5e1; border-radius: 6px; padding: 6px 10px; font-size: 0.85rem; outline: none; }
    </style>
</head>
<body class="py-8 px-4">

    <div class="max-w-[1400px] mx-auto mb-6 flex justify-between items-end no-print">
        <div>
            <h1 class="text-3xl font-extrabold text-gray-900 tracking-tight">RE:BOOT <span class="text-indigo-600">PRO v7.0</span></h1>
            <p class="text-sm text-gray-500 mt-1 font-bold">AI ì œë¯¸ë‚˜ì´ í˜‘ì—…ìš© í…ìŠ¤íŠ¸ ì¶”ì¶œ ì™„ë²½ ì§€ì› ëŒ€ì‹œë³´ë“œ</p>
        </div>
        <div class="flex gap-3 items-center">
            <button onclick="copyCurrentToAI()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-lg font-bold shadow-md transition-all flex items-center">
                <i class="fas fa-robot text-xl mr-2 text-indigo-200"></i>
                í˜„ì¬ í™”ë©´ AIì—ê²Œ ì „ë‹¬í•˜ê¸° (ë³µì‚¬)
            </button>
            <select id="strategy-status" class="bg-white border border-gray-300 text-slate-700 h-[45px] px-4 rounded-lg font-bold outline-none cursor-pointer shadow-sm">
                <option value="ì´ˆì•ˆ ì‘ì„±ì¤‘">ğŸ“ ì´ˆì•ˆ ì‘ì„±ì¤‘</option>
                <option value="ê²€í†  í•„ìš”">ğŸ” ê²€í†  í•„ìš”</option>
                <option value="ì‹¤í–‰ í™•ì •">ğŸš€ ì‹¤í–‰ í™•ì •</option>
            </select>
            <button onclick="exportFullPDF()" class="bg-slate-800 hover:bg-slate-900 text-white px-5 py-2.5 rounded-lg font-bold shadow-md transition-all">
                <i class="fas fa-file-pdf mr-2"></i> PDF ì¶œë ¥
            </button>
        </div>
    </div>

    <div id="print-master-area">
        <div class="dashboard-container mb-10" id="canvas-area">
            
            <div class="mb-8 grid grid-cols-1 lg:grid-cols-4 gap-6">
                <div class="col-span-1 lg:col-span-1">
                    <div class="section-title"><i class="fas fa-list-check"></i> ì „ëµ í•µì‹¬ ìš”ì•½ (ìë™)</div>
                    <div id="auto-summary-board" class="auto-summary-list">
                        <div class="text-slate-400 text-sm text-center mt-12">ì „ëµì„ ì €ì¥í•˜ë©´ ì—¬ê¸°ì— ìš”ì•½ì´ ëˆ„ì ë©ë‹ˆë‹¤.</div>
                    </div>
                </div>

                <div class="col-span-1 lg:col-span-3 flex flex-col">
                    <div class="section-title"><i class="fas fa-stopwatch text-indigo-600"></i> 8ì£¼ ìŠ¤í”„ë¦°íŠ¸ ë¡œë“œë§µ (Gantt Chart)</div>
                    
                    <div class="bg-white border border-slate-300 rounded-lg p-4 flex-1 shadow-sm flex flex-col">
                        <div class="flex gap-2 mb-4 no-print bg-indigo-50 p-2 rounded-lg border border-indigo-200">
                            <input type="text" id="g-name" list="strategy-suggestions" class="gantt-input flex-1 focus:border-indigo-500 font-bold text-indigo-900" placeholder="â–¼ í´ë¦­í•˜ì—¬ ì™¼ìª½ì˜ [ì „ëµ í•µì‹¬ ìš”ì•½] ë‚´ìš©ì„ ì„ íƒí•˜ì„¸ìš”">
                            <datalist id="strategy-suggestions"></datalist>

                            <div class="flex items-center text-sm font-bold text-indigo-800 px-2">ì‹œì‘:</div>
                            <select id="g-start" class="gantt-input bg-white cursor-pointer font-bold text-indigo-700">
                                <option value="1">1ì£¼ì°¨</option><option value="2">2ì£¼ì°¨</option><option value="3">3ì£¼ì°¨</option><option value="4">4ì£¼ì°¨</option>
                                <option value="5">5ì£¼ì°¨</option><option value="6">6ì£¼ì°¨</option><option value="7">7ì£¼ì°¨</option><option value="8">8ì£¼ì°¨</option>
                            </select>
                            <div class="flex items-center text-sm font-bold text-indigo-800 px-2">ì¢…ë£Œ:</div>
                            <select id="g-end" class="gantt-input bg-white cursor-pointer font-bold text-indigo-700">
                                <option value="1">1ì£¼ì°¨</option><option value="2">2ì£¼ì°¨</option><option value="3">3ì£¼ì°¨</option><option value="4">4ì£¼ì°¨</option>
                                <option value="5">5ì£¼ì°¨</option><option value="6">6ì£¼ì°¨</option><option value="7">7ì£¼ì°¨</option><option value="8">8ì£¼ì°¨</option>
                            </select>
                            <button onclick="addGanttTask()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 rounded-lg font-bold transition-colors">
                                <i class="fas fa-plus mr-1"></i> ì¼ì • ë“±ë¡
                            </button>
                        </div>

                        <div class="flex-1 border border-slate-200 rounded-lg overflow-hidden bg-white">
                            <div class="grid grid-cols-[200px_1fr] gap-10 bg-slate-100 border-b border-slate-200 p-2 pr-4">
                                <div class="text-xs font-bold text-slate-500 text-center flex items-center justify-center">í•µì‹¬ ì „ëµ ìš”ì•½ (Task)</div>
                                <div class="grid grid-cols-8 text-center text-[0.75rem] font-extrabold text-slate-600">
                                    <div>W1</div><div>W2</div><div>W3</div><div>W4</div><div class="text-indigo-500">W5</div><div class="text-indigo-500">W6</div><div class="text-indigo-500">W7</div><div class="text-indigo-500">W8</div>
                                </div>
                            </div>
                            <div id="gantt-canvas" class="p-3 min-h-[100px]">
                                <div class="text-slate-400 text-center text-xs mt-6">ìƒë‹¨ì˜ [ì¼ì • ë“±ë¡] ë²„íŠ¼ì„ ëˆŒëŸ¬ 8ì£¼ ì¼ì •ì„ ì±„ì›Œë³´ì„¸ìš”.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-4 gap-4">
                
                <div class="step-col">
                    <div class="step-header bg-slate-700">STEP 01. ë¬¸ì œ ì¸ì‹</div>
                    <div class="box-wrapper"><div class="box-title">í˜„í™© (ì „ëµ ì œëª©)</div><textarea id="p1_1" class="h-[80px]" placeholder="ì˜ˆ: ë§¤ì¶œ ì €í•˜ë¡œ ì¸í•œ íšŒì‚¬ìš´ì˜ ìœ„ê¸°"></textarea></div>
                    <div class="box-wrapper"><div class="box-title">ì›ì¸ ê·œëª…</div><textarea id="p1_2" class="h-[80px]" placeholder="ì˜ˆ: í° ë§¤íŠ¸ë¡œ ì‹œì¥ ë³€í™”"></textarea></div>
                    <div class="box-wrapper mb-0"><div class="box-title">í•µì‹¬ ê³¼ì œ ë„ì¶œ</div><textarea id="p1_3" class="h-[80px]" placeholder="ì˜ˆ: ìš°ë¦¬ë„ 1,000 ë§¤íŠ¸ ì¶œì‹œ"></textarea></div>
                </div>
                
                <div class="step-col">
                    <div class="step-header bg-blue-700">STEP 02. ë°©ì•ˆ íƒìƒ‰</div>
                    <div class="box-wrapper"><div class="box-title">í•´ê²° ëª©í‘œ ìˆ˜ë¦½</div><textarea id="p2_1" class="h-[80px]" placeholder="ì˜ˆ: 8ì£¼ ë‚´ ì›” ë§¤ì¶œ 50ì–µ ë‹¬ì„± ì„¸íŒ…"></textarea></div>
                    <div class="box-wrapper"><div class="box-title">í•´ê²° ë°©ì•ˆ íƒìƒ‰</div><textarea id="p2_2" class="h-[80px]" placeholder="ì˜ˆ: SNS í˜‘ì°¬ ë° ë°•ëŒíšŒ, ì¸í„°ë„· íŒë§¤"></textarea></div>
                    <div class="box-wrapper mb-0"><div class="box-title">ëŒ€ì•ˆë³„ í‰ê°€</div><textarea id="p2_3" class="h-[80px]" placeholder="ì˜ˆ: ë°•ëŒíšŒëŠ” ë¹„ìš©ì´ ë†’ìœ¼ë‚˜ ì¦‰ê°ì ì„"></textarea></div>
                </div>
                
                <div class="step-col flex flex-col">
                    <div class="step-header bg-indigo-700">STEP 03. ì„ ì • ë° ì‹¤í–‰</div>
                    <div class="box-wrapper"><div class="box-title">ìµœì ì•ˆ ì„ ì •</div><textarea id="p3_1" class="h-[80px]" placeholder="ì˜ˆ: ì¸í„°ë„· íŒë§¤ ë©”ì¸, SNS í˜‘ì°¬ ë³‘í–‰"></textarea></div>
                    <div class="box-wrapper mb-4"><div class="box-title">ì„¸ë¶€ ì‹¤í–‰ ê³„íš (Enterë¡œ ì¤„ë°”ê¿ˆ)</div><textarea id="p3_2" class="h-[80px]" placeholder="1. ìƒì„¸í˜ì´ì§€ ì œì‘&#10;2. ë§˜ì¹´í˜ ì²´í—˜ë‹¨ ëª¨ì§‘&#10;3. SNS íƒ€ê²Ÿê´‘ê³  ì„¸íŒ…"></textarea></div>
                    
                    <button onclick="saveToHistory()" class="mt-auto w-full bg-slate-800 hover:bg-slate-900 text-white rounded-lg h-[92px] flex items-center justify-center font-extrabold text-[1.05rem] shadow-xl border border-slate-900 transition-all duration-300 print:hidden leading-snug px-2 text-center">
                        <i class="fas fa-layer-group mr-2 text-xl text-indigo-400"></i> 
                        <span>ì „ëµ ì €ì¥ í›„<br>ìƒˆ ìº”ë²„ìŠ¤ ì—´ê¸°</span>
                    </button>
                    <div class="hidden print:flex bg-slate-100 text-slate-800 rounded-lg h-[92px] items-center justify-center font-black text-lg tracking-widest shadow-inner border border-slate-300 w-full mt-auto">
                        RE:BOOT SPRINT PLAN
                    </div>
                </div>

                <div class="flex flex-col gap-4">
                    <div class="bg-purple-50 border border-purple-200 rounded-xl p-4 shadow-sm flex flex-col h-1/2">
                        <div class="text-[0.95rem] font-extrabold text-purple-800 mb-2 border-b border-purple-200 pb-2 flex items-center">
                            <i class="fas fa-gem mr-2 text-purple-500"></i> ì›í•˜ëŠ” ê²°ê³¼ (Outcome)
                        </div>
                        <textarea id="p_result" class="flex-1 bg-transparent border-none outline-none resize-none text-purple-900 font-semibold placeholder-purple-400 text-[0.85rem]" placeholder="ì´ ì „ëµì´ ì„±ê³µí•˜ë©´ íšŒì‚¬ì— ì–´ë–¤ ê²°ê³¼ê°€ ë‚˜ì˜¤ë‚˜ìš”?"></textarea>
                    </div>

                    <div class="memo-pad relative overflow-hidden rounded-xl p-4 shadow-sm flex flex-col h-1/2 border border-yellow-300">
                        <div class="absolute top-0 right-0 w-8 h-8 bg-yellow-400/50 transform rotate-45 translate-x-4 -translate-y-4"></div>
                        <div class="text-[0.9rem] font-extrabold text-yellow-800 mb-2 border-b border-yellow-300 pb-2 flex items-center">
                            <i class="fas fa-thumbtack mr-2"></i> ì•„ì´ë””ì–´ ë©”ëª¨ì¥
                        </div>
                        <textarea id="memo" class="flex-1 bg-transparent border-none outline-none resize-none text-[0.85rem]" placeholder="ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”."></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="max-w-[1400px] mx-auto pb-20">
            <h2 class="text-xl font-extrabold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-layer-group text-indigo-600 mr-3"></i> 8ì£¼ ìŠ¤í”„ë¦°íŠ¸ ì „ëµ ì•„ì¹´ì´ë¸Œ
                <span id="history-count" class="ml-3 bg-indigo-100 text-indigo-700 text-sm font-bold px-3 py-1 rounded-full">0ê±´</span>
            </h2>
            <div id="history-container" class="space-y-4"></div>
        </div>
    </div> <div id="toast" class="fixed bottom-[-100px] left-1/2 transform -translate-x-1/2 bg-indigo-600 text-white px-8 py-4 rounded-full shadow-2xl z-50 font-bold transition-all duration-300 opacity-0 text-center flex items-center gap-3 border-4 border-indigo-400"></div>

    <script>
        const fields = ['p1_1', 'p1_2', 'p1_3', 'p2_1', 'p2_2', 'p2_3', 'p3_1', 'p3_2', 'p_result', 'memo'];
        const labels = ['í˜„í™©(ì œëª©)', 'ì›ì¸ ê·œëª…', 'í•µì‹¬ ê³¼ì œ', 'í•´ê²° ëª©í‘œ', 'ë°©ì•ˆ íƒìƒ‰', 'ëŒ€ì•ˆ í‰ê°€', 'ìµœì ì•ˆ ê²°ì •', 'ì‹¤í–‰ ê³„íš', 'ì›í•˜ëŠ” ê²°ê³¼', 'ë©”ëª¨'];

        let currentGanttTasks = [];
        const chartColors = ['bg-indigo-500', 'bg-blue-500', 'bg-emerald-500', 'bg-purple-500', 'bg-cyan-600'];

        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.innerHTML = `<i class="fas fa-check-circle text-2xl"></i> ${msg}`;
            toast.classList.replace('bottom-[-100px]', 'bottom-10');
            toast.classList.replace('opacity-0', 'opacity-100');
            setTimeout(() => {
                toast.classList.replace('bottom-10', 'bottom-[-100px]');
                toast.classList.replace('opacity-100', 'opacity-0');
            }, 3000);
        }

        // ğŸŒŸ 1. AI ì»¨ì„¤íŒ…ì„ ìœ„í•œ í…ìŠ¤íŠ¸ ì¶”ì¶œ ë° ë³µì‚¬ í•¨ìˆ˜ (í•µì‹¬ ê¸°ëŠ¥)
        function formatDataForAI(details, gantt) {
            let promptText = `ì•ˆë…• ì œë¯¸ë‚˜ì´! ìš°ë¦¬ íšŒì‚¬ì˜ ìƒˆë¡œìš´ ì‚¬ì—… ì „ëµì„ ê¸°íší–ˆì–´. ì•„ë˜ ë‚´ìš©ì„ ì½ê³  ì»¨ì„¤í„´íŠ¸ ì…ì¥ì—ì„œ í”¼ë“œë°±í•´ ì¤˜.\n\n`;
            promptText += `=====================================\n`;
            promptText += `[ê¸°íšì•ˆ: ${details['í˜„í™©(ì œëª©)'] || 'ë¬´ì œ'}]\n\n`;
            
            promptText += `ğŸ’¡ 1ë‹¨ê³„. ë¬¸ì œ ì¸ì‹\n`;
            promptText += `- í˜„í™©/ë¬¸ì œ: ${details['í˜„í™©(ì œëª©)'] || '-'}\n`;
            promptText += `- ì›ì¸ ë¶„ì„: ${details['ì›ì¸ ê·œëª…'] || '-'}\n`;
            promptText += `- í•µì‹¬ ê³¼ì œ: ${details['í•µì‹¬ ê³¼ì œ'] || '-'}\n\n`;
            
            promptText += `ğŸ¯ 2ë‹¨ê³„. ë°©ì•ˆ íƒìƒ‰\n`;
            promptText += `- í•´ê²° ëª©í‘œ: ${details['í•´ê²° ëª©í‘œ'] || '-'}\n`;
            promptText += `- ëŒ€ì•ˆ íƒìƒ‰: ${details['ë°©ì•ˆ íƒìƒ‰'] || '-'}\n`;
            promptText += `- ëŒ€ì•ˆ í‰ê°€: ${details['ëŒ€ì•ˆ í‰ê°€'] || '-'}\n\n`;
            
            promptText += `ğŸš€ 3ë‹¨ê³„. ì„ ì • ë° ì‹¤í–‰\n`;
            promptText += `- ìµœì ì•ˆ ì„ ì •: ${details['ìµœì ì•ˆ ê²°ì •'] || '-'}\n`;
            promptText += `- ì‹¤í–‰ ê³„íš:\n${details['ì‹¤í–‰ ê³„íš'] || '-'}\n\n`;
            
            promptText += `ğŸ’ 4ë‹¨ê³„. ê¸°ëŒ€ íš¨ê³¼\n`;
            promptText += `- ì›í•˜ëŠ” ê²°ê³¼(Outcome): ${details['ì›í•˜ëŠ” ê²°ê³¼'] || '-'}\n\n`;
            
            if(gantt && gantt.length > 0) {
                promptText += `ğŸ“… 8ì£¼ ì‹¤í–‰ ë¡œë“œë§µ\n`;
                gantt.forEach(task => {
                    promptText += `- ${task.name} : ${task.start}ì£¼ì°¨ ~ ${task.end}ì£¼ì°¨\n`;
                });
            } else {
                promptText += `ğŸ“… 8ì£¼ ì‹¤í–‰ ë¡œë“œë§µ: (ì…ë ¥ëœ ì¼ì • ì—†ìŒ)\n`;
            }
            promptText += `=====================================\n\n`;
            promptText += `[ìš”ì²­ì‚¬í•­]\n1. ì´ ì „ëµì˜ ë§¹ì (í—ˆì )ì´ ìˆë‹¤ë©´ ë¬´ì—‡ì¼ê¹Œ?\n2. 'ì›í•˜ëŠ” ê²°ê³¼'ë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•´ ë‚´ê°€ ë†“ì¹œ 'ì‹¤í–‰ ê³„íš'ì´ë‚˜ 'ë¡œë“œë§µ' ì¼ì •ì„ êµ¬ì²´ì ìœ¼ë¡œ ë³´ì™„í•´ ì¤˜.\n3. ëŒ€í‘œì¸ ë‚´ê°€ ë‹¹ì¥ ë‚´ì¼ ì•„ì¹¨ ê°€ì¥ ë¨¼ì € ì§€ì‹œí•´ì•¼ í•  ì•¡ì…˜ ì•„ì´í…œ 1ê°œë¥¼ ê¼½ì•„ì¤˜.`;
            
            return promptText;
        }

        // í˜„ì¬ ìº”ë²„ìŠ¤ì— ì íŒ ë‚´ìš© ë³µì‚¬
        function copyCurrentToAI() {
            let details = {};
            fields.forEach((id, idx) => {
                details[labels[idx]] = document.getElementById(id).value.trim();
            });
            
            const promptText = formatDataForAI(details, currentGanttTasks);
            
            // ì„ì‹œ í…ìŠ¤íŠ¸ì—ë¦¬ì–´ë¡œ ë³µì‚¬ ì‹¤í–‰
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = promptText;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);
            
            showToast("AI í”„ë¡¬í”„íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!<br>ì œë¯¸ë‚˜ì´ ì±„íŒ…ì°½ì— ë¶™ì—¬ë„£ê¸°(Ctrl+V) í•˜ì„¸ìš”.");
        }

        // ì €ì¥ëœ íŠ¹ì • ì¹´ë“œ ë‚´ìš© ë³µì‚¬
        function copyArchivedToAI(id) {
            const history = JSON.parse(localStorage.getItem('pro_v7_0_history') || "[]");
            const item = history.find(h => h.id === id);
            if(item) {
                const promptText = formatDataForAI(item.details, item.gantt);
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = promptText;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextArea);
                showToast("ì´ ì „ëµì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!<br>AIì—ê²Œ ë°”ë¡œ ì „ë‹¬í•´ ë³´ì„¸ìš”.");
            }
        }


        // ğŸŒŸ 2. ë®ì–´ì“°ê¸° ë¡œì§ ì™„ì „ ì‚­ì œ, ë¬´ì¡°ê±´ ìƒˆë¡œ ì €ì¥!
        function saveToHistory() {
            let hasContent = false;
            let newDetails = {};

            fields.forEach((id, idx) => {
                const val = document.getElementById(id).value.trim();
                if(val) { newDetails[labels[idx]] = val; hasContent = true; }
            });

            if(!hasContent && currentGanttTasks.length === 0) return alert("ì €ì¥í•  ë‚´ìš©ì„ í•˜ë‚˜ë¼ë„ ì…ë ¥í•´ì£¼ì„¸ìš”.");

            let history = JSON.parse(localStorage.getItem('pro_v7_0_history') || "[]");

            // ë¬´ì¡°ê±´ ìƒˆë¡œìš´ ì•„ì´ë””ë¡œ ì¶”ê°€ (ë®ì–´ì“°ê¸° ì•ˆí•¨)
            history.unshift({ 
                id: Date.now(), 
                date: new Date().toLocaleString('ko-KR'), 
                status: document.getElementById('strategy-status').value,
                details: newDetails, 
                gantt: [...currentGanttTasks] 
            });

            localStorage.setItem('pro_v7_0_history', JSON.stringify(history));

            // ì €ì¥ í›„ í™”ë©´ ì™„ë²½ ì´ˆê¸°í™”
            fields.forEach(id => document.getElementById(id).value = "");
            currentGanttTasks = [];
            document.getElementById('strategy-status').value = "ì´ˆì•ˆ ì‘ì„±ì¤‘";
            document.getElementById('g-name').value = '';
            
            drawGantt();
            renderHistory();
            updateGanttSuggestions(); 
            
            showToast("ì €ì¥ ì™„ë£Œ!<br>ìº”ë²„ìŠ¤ê°€ ë¹„ì›Œì¡ŒìŠµë‹ˆë‹¤. ìƒˆ ì „ëµì„ ì‘ì„±í•˜ì„¸ìš”.");
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        }


        function updateGanttSuggestions() {
            const datalist = document.getElementById('strategy-suggestions');
            datalist.innerHTML = ''; 
            const currentTitle = document.getElementById('p1_1').value.trim();
            if(currentTitle) {
                const opt = document.createElement('option');
                opt.value = `[ì‘ì„±ì¤‘] ${currentTitle}`;
                datalist.appendChild(opt);
            }
            const history = JSON.parse(localStorage.getItem('pro_v7_0_history') || "[]");
            history.forEach(item => {
                const title = item.details["í˜„í™©(ì œëª©)"] || "ë¬´ì œ ì „ëµ";
                const task = item.details["í•µì‹¬ ê³¼ì œ"] || "";
                const opt = document.createElement('option');
                opt.value = `${title} â” ${task}`;
                datalist.appendChild(opt);
            });
        }

        window.onload = () => {
            drawGantt();
            renderHistory();
            updateGanttSuggestions(); 
            
            // ì…ë ¥í•  ë•Œë§ˆë‹¤ ë“œë¡­ë‹¤ìš´ ê°±ì‹ 
            document.getElementById('p1_1').addEventListener('input', updateGanttSuggestions);
        };

        function addGanttTask() {
            const name = document.getElementById('g-name').value.trim();
            const start = parseInt(document.getElementById('g-start').value);
            const end = parseInt(document.getElementById('g-end').value);

            if(!name) return alert("ì™¼ìª½ ì „ëµ ìš”ì•½ì„ ì„ íƒí•˜ê±°ë‚˜ ì§ì ‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            if(start > end) return alert("ì‹œì‘ ì£¼ì°¨ê°€ ì¢…ë£Œ ì£¼ì°¨ë³´ë‹¤ ëŠ¦ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!");

            currentGanttTasks.push({ id: Date.now(), name, start, end });
            document.getElementById('g-name').value = '';
            document.getElementById('g-start').value = end; 
            drawGantt();
        }

        function removeGanttTask(id) {
            currentGanttTasks = currentGanttTasks.filter(t => t.id !== id);
            drawGantt();
        }

        function drawGantt() {
            const canvas = document.getElementById('gantt-canvas');
            if(currentGanttTasks.length === 0) {
                canvas.innerHTML = '<div class="text-slate-400 text-center text-xs mt-6">ìƒë‹¨ì˜ [ì¼ì • ë“±ë¡] ë²„íŠ¼ì„ ëˆŒëŸ¬ 8ì£¼ ì¼ì •ì„ ì±„ì›Œë³´ì„¸ìš”.</div>';
                return;
            }

            canvas.innerHTML = '';
            currentGanttTasks.forEach((task, index) => {
                const color = chartColors[index % chartColors.length];
                const span = (task.end - task.start) + 1; 
                canvas.innerHTML += `
                    <div class="gantt-grid">
                        <div class="text-xs font-bold text-slate-700 truncate pr-2 flex justify-between items-center bg-white border border-slate-100 p-1.5 rounded">
                            <span class="truncate" title="${task.name}">${task.name}</span>
                            <i class="fas fa-times text-slate-300 hover:text-red-500 cursor-pointer no-print ml-1" onclick="removeGanttTask(${task.id})"></i>
                        </div>
                        <div class="gantt-track">
                            <div class="gantt-bar ${color}" style="grid-column: ${task.start} / span ${span};">
                                ${task.start === task.end ? task.start + 'ì£¼ì°¨' : 'W' + task.start + ' ~ W' + task.end}
                            </div>
                        </div>
                    </div>
                `;
            });
        }


        function renderHistory() {
            const container = document.getElementById('history-container');
            const summaryBoard = document.getElementById('auto-summary-board');
            const history = JSON.parse(localStorage.getItem('pro_v7_0_history') || "[]");
            
            document.getElementById('history-count').innerText = `${history.length}ê±´`;

            if(history.length === 0) {
                container.innerHTML = `<div class="text-center py-8 bg-white rounded-xl shadow-sm text-gray-400">ì €ì¥ëœ ì „ëµì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
                summaryBoard.innerHTML = `<div class="text-slate-400 text-sm text-center mt-12">ì „ëµì„ ì €ì¥í•˜ë©´ ì—¬ê¸°ì— ìš”ì•½ì´ ëˆ„ì ë©ë‹ˆë‹¤.</div>`;
                return;
            }

            let summaryHtml = "";
            let containerHtml = "";

            history.forEach((item, index) => {
                const title = item.details["í˜„í™©(ì œëª©)"] || `ìƒˆë¡œìš´ ì „ëµ #${history.length - index}`;
                const coreTask = item.details["í•µì‹¬ ê³¼ì œ"] || "-";
                const outcome = item.details["ì›í•˜ëŠ” ê²°ê³¼"] ? `â” ğŸ¯ ${item.details["ì›í•˜ëŠ” ê²°ê³¼"]}` : '';
                const taskCount = item.gantt ? item.gantt.length : 0;
                
                let statusColor = "bg-gray-100 text-gray-600";
                if(item.status.includes("ê²€í† ")) statusColor = "bg-orange-100 text-orange-700";
                if(item.status.includes("í™•ì •")) statusColor = "bg-green-100 text-green-700";

                summaryHtml += `
                    <div class="auto-summary-item flex flex-col justify-center">
                        <div class="flex items-center mb-1">
                            <span class="${statusColor} text-[10px] font-bold px-2 py-0.5 rounded mr-2 whitespace-nowrap">${item.status}</span>
                            <span class="text-[10px] bg-indigo-50 text-indigo-600 px-2 py-0.5 rounded font-bold"><i class="fas fa-tasks mr-1"></i>íƒœìŠ¤í¬ ${taskCount}ê°œ</span>
                        </div>
                        <div class="truncate text-slate-700 font-medium text-[0.8rem]">
                            <b class="text-indigo-700">[${title}]</b> â” ${coreTask} ${outcome}
                        </div>
                    </div>
                `;

                // í‘œì‹œí•  í•­ëª©: ê³¼ì œ, ëª©í‘œ, ê²°ê³¼, ê²°ì •
                const previewLabels = ['í•µì‹¬ ê³¼ì œ', 'í•´ê²° ëª©í‘œ', 'ì›í•˜ëŠ” ê²°ê³¼', 'ìµœì ì•ˆ ê²°ì •']; 
                const detailsHtml = previewLabels.map(key => {
                    if(item.details[key]) {
                        const colorClass = key === 'ì›í•˜ëŠ” ê²°ê³¼' ? 'text-purple-600' : 'text-blue-600';
                        const bgClass = key === 'ì›í•˜ëŠ” ê²°ê³¼' ? 'bg-purple-50 border-purple-100' : 'bg-gray-50 border-gray-100';
                        return `<div class="${bgClass} p-2 rounded border"><div class="text-[10px] font-bold ${colorClass} mb-1">${key}</div><div class="text-xs text-gray-700 whitespace-pre-wrap">${item.details[key]}</div></div>`;
                    } return '';
                }).join('');

                containerHtml += `
                    <div id="card-${item.id}" class="history-card bg-white p-5 rounded-xl shadow-sm border border-gray-200">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex flex-col">
                                <div class="flex items-center mb-1">
                                    <span class="${statusColor} text-[10px] font-bold px-2 py-1 rounded mr-2">${item.status}</span>
                                    <span class="text-xs text-gray-400">${item.date}</span>
                                </div>
                                <h3 class="text-md font-extrabold text-gray-900">${title}</h3>
                            </div>
                            <div class="flex gap-2 no-print card-buttons">
                                <button onclick="copyArchivedToAI(${item.id})" class="text-xs bg-indigo-50 text-indigo-700 hover:bg-indigo-100 px-3 py-1.5 rounded font-bold transition flex items-center">
                                    <i class="fas fa-robot mr-1"></i> AIì „ë‹¬ ë³µì‚¬
                                </button>
                                <button onclick="loadStrategy(${item.id})" class="text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 px-3 py-1.5 rounded font-bold transition">ë¶ˆëŸ¬ì˜¤ê¸°(ì°¸ê³ ìš©)</button>
                                <button onclick="deleteStrategy(${item.id})" class="text-xs text-red-400 hover:text-red-600 p-1.5"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        <div class="grid grid-cols-4 gap-2">${detailsHtml}</div>
                    </div>
                `;
            });

            summaryBoard.innerHTML = summaryHtml;
            container.innerHTML = containerHtml;
        }

        // ë¶ˆëŸ¬ì˜¤ê¸° (ìˆ˜ì •ìš©ì´ ì•„ë‹˜, ê·¸ëƒ¥ í™”ë©´ì— ë„ì›Œì£¼ëŠ” ìš©ë„)
        function loadStrategy(id) {
            if(confirm("í˜„ì¬ ìº”ë²„ìŠ¤ì˜ ë‚´ìš©ì„ ì§€ìš°ê³  ê³¼ê±° ì „ëµì„ ë¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                const history = JSON.parse(localStorage.getItem('pro_v7_0_history') || "[]");
                const item = history.find(h => h.id === id);
                if(item) {
                    fields.forEach((fieldId, idx) => { document.getElementById(fieldId).value = item.details[labels[idx]] || ""; });
                    document.getElementById('strategy-status').value = item.status || "ì´ˆì•ˆ ì‘ì„±ì¤‘";
                    currentGanttTasks = item.gantt ? [...item.gantt] : [];
                    
                    drawGantt();
                    updateGanttSuggestions();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    showToast("ê¸°ì¡´ ì „ëµì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.<br>ì´ ë‚´ìš©ì„ ìˆ˜ì • í›„ ì €ì¥í•˜ë©´ 'ìƒˆë¡œìš´ ì „ëµ'ìœ¼ë¡œ 1ê°œ ë” ì¶”ê°€ë©ë‹ˆë‹¤.");
                }
            }
        }

        function deleteStrategy(id) {
            if(confirm("ì´ ì „ëµì„ ì˜êµ¬ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                let history = JSON.parse(localStorage.getItem('pro_v7_0_history') || "[]");
                history = history.filter(h => h.id !== id);
                localStorage.setItem('pro_v7_0_history', JSON.stringify(history));
                renderHistory();
                updateGanttSuggestions();
            }
        }

        // ğŸŒŸ 3. PDF í¬ë§·íŒ… êµì • ë¡œì§
        function expandTextareas() {
            const textareas = document.querySelectorAll('textarea');
            textareas.forEach(ta => {
                ta.dataset.origHeight = ta.style.height || ''; 
                ta.style.height = 'auto'; 
                ta.style.height = (ta.scrollHeight + 10) + 'px'; // í…ìŠ¤íŠ¸ ì§¤ë¦¼ ë°©ì§€
            });
        }

        function restoreTextareas() {
            const textareas = document.querySelectorAll('textarea');
            textareas.forEach(ta => {
                ta.style.height = ta.dataset.origHeight;
            });
        }

        function exportFullPDF() {
            // PDFê°€ ì•„ë‹Œ AI ì¶”ì¶œì„ ê¶Œì¥í•˜ëŠ” ì•Œë¦¼
            alert("ğŸ’¡ PDF ì €ì¥ì„ ì‹œì‘í•©ë‹ˆë‹¤.\n\n(ì°¸ê³ : ì œë¯¸ë‚˜ì´ì™€ íšŒì˜í•  ëª©ì ì´ë¼ë©´, ìƒë‹¨ì˜ [AIì—ê²Œ ì „ë‹¬í•˜ê¸°] ë²„íŠ¼ì„ ëˆŒëŸ¬ í…ìŠ¤íŠ¸ë¡œ ë³µì‚¬í•˜ëŠ” ê²ƒì´ í›¨ì”¬ ê°•ë ¥í•˜ê³  ë¹ ë¦…ë‹ˆë‹¤!)");
            
            expandTextareas(); 
            
            const noPrints = document.querySelectorAll('.no-print');
            noPrints.forEach(el => el.style.display = 'none');
            
            const origScroll = window.scrollY;
            window.scrollTo(0, 0); 

            const element = document.getElementById('print-master-area');
            const opt = { 
                margin: [10, 5, 10, 5], 
                filename: `REBOOT_Strategy_Report.pdf`, 
                image: { type: 'jpeg', quality: 1 }, 
                html2canvas: { scale: 1.5, useCORS: true, scrollY: 0 }, 
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'landscape' } 
            };
            
            html2pdf().set(opt).from(element).save().then(() => {
                restoreTextareas(); 
                noPrints.forEach(el => el.style.display = '');
                window.scrollTo(0, origScroll);
            });
        }
    </script>
</body>
</html>
